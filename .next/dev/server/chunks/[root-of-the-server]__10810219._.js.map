{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///project/workspace/lib/db.ts"],"sourcesContent":["// lib/db.ts\nimport { MongoClient, Db } from \"mongodb\";\n\nconst uri = process.env.MONGODB_URI as string;\nconst dbName = process.env.DB_NAME as string; // you shared DB_NAME; use that name\n\nif (!uri) throw new Error(\"MONGODB_URI is not set\");\nif (!dbName) throw new Error(\"DB_NAME is not set\");\n\ntype Cached = {\n  client: MongoClient | null;\n  promise: Promise<MongoClient> | null;\n};\nconst globalForMongo = globalThis as unknown as { _mongo?: Cached };\nconst cached: Cached = globalForMongo._mongo ?? { client: null, promise: null };\nglobalForMongo._mongo = cached;\n\nexport async function connectToDatabase(): Promise<{\n  client: MongoClient;\n  db: Db;\n}> {\n  if (cached.client) {\n    return { client: cached.client, db: cached.client.db(dbName) };\n  }\n  if (!cached.promise) {\n    cached.promise = MongoClient.connect(uri);\n  }\n  const client = await cached.promise;\n  cached.client = client;\n  return { client, db: client.db(dbName) };\n}\n"],"names":[],"mappings":"AAAA,YAAY;;;;;AACZ;;AAEA,MAAM,MAAM,QAAQ,GAAG,CAAC,WAAW;AACnC,MAAM,SAAS,QAAQ,GAAG,CAAC,OAAO,EAAY,oCAAoC;AAElF,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;AAC1B,IAAI,CAAC,QAAQ,MAAM,IAAI,MAAM;AAM7B,MAAM,iBAAiB;AACvB,MAAM,SAAiB,eAAe,MAAM,IAAI;IAAE,QAAQ;IAAM,SAAS;AAAK;AAC9E,eAAe,MAAM,GAAG;AAEjB,eAAe;IAIpB,IAAI,OAAO,MAAM,EAAE;QACjB,OAAO;YAAE,QAAQ,OAAO,MAAM;YAAE,IAAI,OAAO,MAAM,CAAC,EAAE,CAAC;QAAQ;IAC/D;IACA,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,OAAO,OAAO,GAAG,sHAAW,CAAC,OAAO,CAAC;IACvC;IACA,MAAM,SAAS,MAAM,OAAO,OAAO;IACnC,OAAO,MAAM,GAAG;IAChB,OAAO;QAAE;QAAQ,IAAI,OAAO,EAAE,CAAC;IAAQ;AACzC","debugId":null}},
    {"offset": {"line": 96, "column": 0}, "map": {"version":3,"sources":["file:///project/workspace/lib/password.ts"],"sourcesContent":["import bcrypt from \"bcryptjs\"\n\nexport async function hashPassword(password: string): Promise<string> {\n  const salt = await bcrypt.genSalt(10)\n  return bcrypt.hash(password, salt)\n}\n\nexport async function comparePasswords(password: string, hash: string): Promise<boolean> {\n  return bcrypt.compare(password, hash)\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEO,eAAe,aAAa,QAAgB;IACjD,MAAM,OAAO,MAAM,8IAAM,CAAC,OAAO,CAAC;IAClC,OAAO,8IAAM,CAAC,IAAI,CAAC,UAAU;AAC/B;AAEO,eAAe,iBAAiB,QAAgB,EAAE,IAAY;IACnE,OAAO,8IAAM,CAAC,OAAO,CAAC,UAAU;AAClC","debugId":null}},
    {"offset": {"line": 133, "column": 0}, "map": {"version":3,"sources":["file:///project/workspace/lib/auth.ts"],"sourcesContent":["import jwt from \"jsonwebtoken\"\nimport { cookies } from \"next/headers\"\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"your-secret-key-change-in-production\"\n\nexport interface DecodedToken {\n  userId: string\n  email: string\n  iat: number\n  exp: number\n}\n\nexport function createToken(userId: string, email: string): string {\n  return jwt.sign({ userId, email }, JWT_SECRET, { expiresIn: \"7d\" })\n}\n\nexport async function verifyToken(token: string): Promise<DecodedToken | null> {\n  try {\n    const decoded = jwt.verify(token, JWT_SECRET) as DecodedToken\n    return decoded\n  } catch (error) {\n    return null\n  }\n}\n\nexport async function getAuthTokenFromCookies(): Promise<string | null> {\n  const cookieStore = await cookies()\n  return cookieStore.get(\"authToken\")?.value || null\n}\n\nexport async function setAuthTokenCookie(token: string): Promise<void> {\n  const cookieStore = await cookies()\n  cookieStore.set(\"authToken\", token, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === \"production\",\n    sameSite: \"lax\",\n    maxAge: 7 * 24 * 60 * 60, // 7 days\n    path: \"/\",\n  })\n}\n\nexport async function clearAuthTokenCookie(): Promise<void> {\n  const cookieStore = await cookies()\n  cookieStore.delete(\"authToken\")\n}\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AACA;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAStC,SAAS,YAAY,MAAc,EAAE,KAAa;IACvD,OAAO,kJAAG,CAAC,IAAI,CAAC;QAAE;QAAQ;IAAM,GAAG,YAAY;QAAE,WAAW;IAAK;AACnE;AAEO,eAAe,YAAY,KAAa;IAC7C,IAAI;QACF,MAAM,UAAU,kJAAG,CAAC,MAAM,CAAC,OAAO;QAClC,OAAO;IACT,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,OAAO,YAAY,GAAG,CAAC,cAAc,SAAS;AAChD;AAEO,eAAe,mBAAmB,KAAa;IACpD,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,YAAY,GAAG,CAAC,aAAa,OAAO;QAClC,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;QACV,QAAQ,IAAI,KAAK,KAAK;QACtB,MAAM;IACR;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,YAAY,MAAM,CAAC;AACrB","debugId":null}},
    {"offset": {"line": 188, "column": 0}, "map": {"version":3,"sources":["file:///project/workspace/app/api/auth/signup/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\nimport { getUserByEmail, createUser } from \"@/lib/db\"\nimport { hashPassword } from \"@/lib/password\"\nimport { createToken, setAuthTokenCookie } from \"@/lib/auth\"\n\nexport async function POST(request: NextRequest) {\n  try {\n    const { email, password, confirmPassword } = await request.json()\n\n    // Validation\n    if (!email || !password || !confirmPassword) {\n      return NextResponse.json({ error: \"Email and password are required\" }, { status: 400 })\n    }\n\n    if (password !== confirmPassword) {\n      return NextResponse.json({ error: \"Passwords do not match\" }, { status: 400 })\n    }\n\n    if (password.length < 6) {\n      return NextResponse.json({ error: \"Password must be at least 6 characters\" }, { status: 400 })\n    }\n\n    // Check if user already exists\n    const existingUser = await getUserByEmail(email)\n    if (existingUser) {\n      return NextResponse.json({ error: \"Email already registered\" }, { status: 409 })\n    }\n\n    // Hash password and create user\n    const hashedPassword = await hashPassword(password)\n    const userId = await createUser(email, hashedPassword)\n\n    // Create JWT token\n    const token = createToken(userId, email)\n\n    // Create response\n    const response = NextResponse.json({ success: true, user: { id: userId, email } }, { status: 201 })\n\n    // Set auth cookie\n    await setAuthTokenCookie(token)\n\n    return response\n  } catch (error) {\n    console.error(\"Signup error:\", error)\n    return NextResponse.json({ error: \"An error occurred during signup\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,eAAe,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE/D,aAAa;QACb,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,iBAAiB;YAC3C,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAkC,GAAG;gBAAE,QAAQ;YAAI;QACvF;QAEA,IAAI,aAAa,iBAAiB;YAChC,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAyB,GAAG;gBAAE,QAAQ;YAAI;QAC9E;QAEA,IAAI,SAAS,MAAM,GAAG,GAAG;YACvB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAyC,GAAG;gBAAE,QAAQ;YAAI;QAC9F;QAEA,+BAA+B;QAC/B,MAAM,eAAe,MAAM,IAAA,6HAAc,EAAC;QAC1C,IAAI,cAAc;YAChB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA2B,GAAG;gBAAE,QAAQ;YAAI;QAChF;QAEA,gCAAgC;QAChC,MAAM,iBAAiB,MAAM,IAAA,iIAAY,EAAC;QAC1C,MAAM,SAAS,MAAM,IAAA,yHAAU,EAAC,OAAO;QAEvC,mBAAmB;QACnB,MAAM,QAAQ,IAAA,4HAAW,EAAC,QAAQ;QAElC,kBAAkB;QAClB,MAAM,WAAW,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,MAAM;gBAAE,IAAI;gBAAQ;YAAM;QAAE,GAAG;YAAE,QAAQ;QAAI;QAEjG,kBAAkB;QAClB,MAAM,IAAA,mIAAkB,EAAC;QAEzB,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,iBAAiB;QAC/B,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAkC,GAAG;YAAE,QAAQ;QAAI;IACvF;AACF","debugId":null}}]
}