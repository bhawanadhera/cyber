{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///project/workspace/lib/db.ts"],"sourcesContent":["import { MongoClient } from \"mongodb\";\n\nlet cachedClient: MongoClient | null = null;\nlet cachedDb: any = null;\n\nexport async function connectToDatabase() {\n  if (cachedClient && cachedDb) {\n    return { client: cachedClient, db: cachedDb };\n  }\n\n  const client = new MongoClient(process.env.MONGODB_URI, {\n    tls: true,\n    tlsAllowInvalidCertificates: true,\n  });\n\n  await client.connect();\n  const db = client.db(process.env.DB_NAME);\n\n  cachedClient = client;\n  cachedDb = db;\n\n  return { client, db };\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEA,IAAI,eAAmC;AACvC,IAAI,WAAgB;AAEb,eAAe;IACpB,IAAI,gBAAgB,UAAU;QAC5B,OAAO;YAAE,QAAQ;YAAc,IAAI;QAAS;IAC9C;IAEA,MAAM,SAAS,IAAI,sHAAW,CAAC,QAAQ,GAAG,CAAC,WAAW,EAAE;QACtD,KAAK;QACL,6BAA6B;IAC/B;IAEA,MAAM,OAAO,OAAO;IACpB,MAAM,KAAK,OAAO,EAAE,CAAC,QAAQ,GAAG,CAAC,OAAO;IAExC,eAAe;IACf,WAAW;IAEX,OAAO;QAAE;QAAQ;IAAG;AACtB","debugId":null}},
    {"offset": {"line": 90, "column": 0}, "map": {"version":3,"sources":["file:///project/workspace/lib/password.ts"],"sourcesContent":["import bcrypt from \"bcryptjs\"\n\nexport async function hashPassword(password: string): Promise<string> {\n  const salt = await bcrypt.genSalt(10)\n  return bcrypt.hash(password, salt)\n}\n\nexport async function comparePasswords(password: string, hash: string): Promise<boolean> {\n  return bcrypt.compare(password, hash)\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEO,eAAe,aAAa,QAAgB;IACjD,MAAM,OAAO,MAAM,8IAAM,CAAC,OAAO,CAAC;IAClC,OAAO,8IAAM,CAAC,IAAI,CAAC,UAAU;AAC/B;AAEO,eAAe,iBAAiB,QAAgB,EAAE,IAAY;IACnE,OAAO,8IAAM,CAAC,OAAO,CAAC,UAAU;AAClC","debugId":null}},
    {"offset": {"line": 127, "column": 0}, "map": {"version":3,"sources":["file:///project/workspace/lib/auth.ts"],"sourcesContent":["import jwt from \"jsonwebtoken\"\nimport { cookies } from \"next/headers\"\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"your-secret-key-change-in-production\"\n\nexport interface DecodedToken {\n  userId: string\n  email: string\n  iat: number\n  exp: number\n}\n\nexport function createToken(userId: string, email: string): string {\n  return jwt.sign({ userId, email }, JWT_SECRET, { expiresIn: \"7d\" })\n}\n\nexport async function verifyToken(token: string): Promise<DecodedToken | null> {\n  try {\n    const decoded = jwt.verify(token, JWT_SECRET) as DecodedToken\n    return decoded\n  } catch (error) {\n    return null\n  }\n}\n\nexport async function getAuthTokenFromCookies(): Promise<string | null> {\n  const cookieStore = await cookies()\n  return cookieStore.get(\"authToken\")?.value || null\n}\n\nexport async function setAuthTokenCookie(token: string): Promise<void> {\n  const cookieStore = await cookies()\n  cookieStore.set(\"authToken\", token, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === \"production\",\n    sameSite: \"lax\",\n    maxAge: 7 * 24 * 60 * 60, // 7 days\n    path: \"/\",\n  })\n}\n\nexport async function clearAuthTokenCookie(): Promise<void> {\n  const cookieStore = await cookies()\n  cookieStore.delete(\"authToken\")\n}\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AACA;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAStC,SAAS,YAAY,MAAc,EAAE,KAAa;IACvD,OAAO,kJAAG,CAAC,IAAI,CAAC;QAAE;QAAQ;IAAM,GAAG,YAAY;QAAE,WAAW;IAAK;AACnE;AAEO,eAAe,YAAY,KAAa;IAC7C,IAAI;QACF,MAAM,UAAU,kJAAG,CAAC,MAAM,CAAC,OAAO;QAClC,OAAO;IACT,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,OAAO,YAAY,GAAG,CAAC,cAAc,SAAS;AAChD;AAEO,eAAe,mBAAmB,KAAa;IACpD,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,YAAY,GAAG,CAAC,aAAa,OAAO;QAClC,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;QACV,QAAQ,IAAI,KAAK,KAAK;QACtB,MAAM;IACR;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,YAAY,MAAM,CAAC;AACrB","debugId":null}},
    {"offset": {"line": 182, "column": 0}, "map": {"version":3,"sources":["file:///project/workspace/app/api/auth/login/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\nimport { getUserByEmail } from \"@/lib/db\"\nimport { comparePasswords } from \"@/lib/password\"\nimport { createToken, setAuthTokenCookie } from \"@/lib/auth\"\n\nexport async function POST(request: NextRequest) {\n  try {\n    const { email, password } = await request.json()\n\n    // Validation\n    if (!email || !password) {\n      return NextResponse.json({ error: \"Email and password are required\" }, { status: 400 })\n    }\n\n    // Find user\n    const user = await getUserByEmail(email)\n    if (!user) {\n      return NextResponse.json({ error: \"Invalid email or password\" }, { status: 401 })\n    }\n\n    // Check password\n    const passwordMatch = await comparePasswords(password, user.password)\n    if (!passwordMatch) {\n      return NextResponse.json({ error: \"Invalid email or password\" }, { status: 401 })\n    }\n\n    // Create JWT token\n    const token = createToken(user._id.toString(), email)\n\n    // Create response\n    const response = NextResponse.json({ success: true, user: { id: user._id.toString(), email } }, { status: 200 })\n\n    // Set auth cookie\n    await setAuthTokenCookie(token)\n\n    return response\n  } catch (error) {\n    console.error(\"Login error:\", error)\n    return NextResponse.json({ error: \"An error occurred during login\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE9C,aAAa;QACb,IAAI,CAAC,SAAS,CAAC,UAAU;YACvB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAkC,GAAG;gBAAE,QAAQ;YAAI;QACvF;QAEA,YAAY;QACZ,MAAM,OAAO,MAAM,IAAA,6HAAc,EAAC;QAClC,IAAI,CAAC,MAAM;YACT,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA4B,GAAG;gBAAE,QAAQ;YAAI;QACjF;QAEA,iBAAiB;QACjB,MAAM,gBAAgB,MAAM,IAAA,qIAAgB,EAAC,UAAU,KAAK,QAAQ;QACpE,IAAI,CAAC,eAAe;YAClB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA4B,GAAG;gBAAE,QAAQ;YAAI;QACjF;QAEA,mBAAmB;QACnB,MAAM,QAAQ,IAAA,4HAAW,EAAC,KAAK,GAAG,CAAC,QAAQ,IAAI;QAE/C,kBAAkB;QAClB,MAAM,WAAW,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,MAAM;gBAAE,IAAI,KAAK,GAAG,CAAC,QAAQ;gBAAI;YAAM;QAAE,GAAG;YAAE,QAAQ;QAAI;QAE9G,kBAAkB;QAClB,MAAM,IAAA,mIAAkB,EAAC;QAEzB,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAiC,GAAG;YAAE,QAAQ;QAAI;IACtF;AACF","debugId":null}}]
}